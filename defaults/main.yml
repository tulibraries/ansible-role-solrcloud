---

## ZOOKEEPER CONFIGURATIONS
## ------------------------
## General
zookeeper_version: 3.5.5

## Service options
# User & Group
zookeeper_user: zookeeper
zookeeper_group: zookeeper

# (Re)Start Zookeeper on Server (Re)Boot?
zookeeper_service_enabled: 'yes'

# Systemd Service Current State (started, stopped)
zookeeper_service_state: started

# Files & Paths
zookeeper_data_dir: /usr/local/zookeeper
zookeeper_log_dir: /var/log/zookeeper
zookeeper_install_path: /opt/zookeeper
zookeeper_conf_dir: "{{ zookeeper_install_path }}/conf"

## Connection properties
zookeeper_client_port: 2181
zookeeper_init_limit: 5
zookeeper_sync_limit: 2
zookeeper_tick_time: 2000
zookeeper_autopurge_purgeInterval: 0
zookeeper_autopurge_snapRetainCount: 10

# Java options
zookeeper_jmx_enabled: true
zookeeper_jmx_port: 1099
zookeeper_java_opts: "-Djava.net.preferIPv4Stack=true"

# Rolling file appender setttings
zookeeper_rolling_log_file_max_size: 10MB
zookeeper_max_rolling_log_file_count: 10

# Zookeeper Node IDs
# List of dict (i.e. {zookeeper_hosts:[{host:,id:},{host:,id:},...]})
zookeeper_hosts:
  - host: "{{ hostvars[groups['zookeeper'][0]].ansible_host }}"
    id: 1

# Dict of ENV settings to be written into the (optional) conf/zookeeper-env.sh
zookeeper_env: {}

# Controls Zookeeper myid generation
zookeeper_force_myid: true
zookeeper_force_reinstall: false

# You can add more zookeper config options using zookeeper_config_map
#
# zookeeper_config_map:
#  - key: traceFile
#    value: zoo-trace.log

## SOLRCLOUD CONFIGURATIONS
## ------------------------
## General
solr_version: 8.1.1
solrcloud_install: true

## Service options
# User & Group
solr_user: solr
solr_group: solr

# (Re)Start Service on Box (Re)Boot?
solr_service_enabled: true
solr_service_state: started  # current state: started, stopped

# Files & Paths
solr_installation_dir: /opt/solr
solr_templates_dir: templates
solr_log_dir: /var/log/solr
solr_home: /var/solr
solr_data_dir: "{{ solr_home }}/data"
solr_collections_config_tmp_dir: /tmp/collections

# Logs
solr_log_root_level: WARN
solr_log_file_size: 500MB
solr_log_max_backup_index: 9
solr_log_config_file: log4j2.xml
solr_log_file_name: solr.log
solr_log_slow_queries_file_name: solr_slow_requests.log

# Ports
solr_host: "{{ hostvars[ansible_nodename]['ansible_' + ansible_default_ipv4.alias]['ipv4']['address'] }}"
solr_port: 8983
solr_url: http://{{ solr_host }}:{{ solr_port }}/solr
solr_jmx_enabled: 'true'
solr_jmx_port: 1099

# JVM
solr_gc_tune: "-XX:NewRatio=3 \
-XX:SurvivorRatio=4 \
-XX:TargetSurvivorRatio=90 \
-XX:MaxTenuringThreshold=8 \
-XX:+UseG1GC \
-XX:ConcGCThreads=4 \
-XX:ParallelGCThreads=4 \
-XX:+CMSScavengeBeforeRemark \
-XX:PretenureSizeThreshold=64m \
-XX:+UseCMSInitiatingOccupancyOnly \
-XX:CMSInitiatingOccupancyFraction=50 \
-XX:CMSMaxAbortablePrecleanTime=6000 \
-XX:+CMSParallelRemarkEnabled \
-XX:+ParallelRefProcEnabled \
-XX:+UseTLAB"
solr_stack_size: 256k
solr_heap: 512m

# Jetty
solr_jetty_threads_min: 10
solr_jetty_threads_max: 10000
solr_jetty_threads_idle_timeout: 5000
solr_jetty_threads_stop_timeout: 60000
solr_jetty_secure_port: 8443
solr_jetty_output_buffer_size: 32768
solr_jetty_output_aggregation_size: 8192
solr_jetty_request_header_size: 8192
solr_jetty_response_header_size: 8192
solr_jetty_send_server_version: 'false'
solr_jetty_send_date_header: 'false'
solr_jetty_header_cache_size: 512
solr_jetty_delay_dispatch_until_content: 'false'
solr_jetty_http_selectors: -1
solr_jetty_http_acceptors: -1

# Zookeeper
solr_zookeeper_hosts:
  - "{{ hostvars[groups['zookeeper'][0]].ansible_host }}:{{ zookeeper_client_port | int }}"
solr_zookeeper_hosts_solr_path: solr
solr_zk_host: "{{ solr_zookeeper_hosts }}/{{ solr_zookeeper_hosts_solr_path }}"
solr_zookeeper_client_path: "{{ solr_installation_dir }}/server/scripts/cloud-scripts"
solr_zookeeper_client_timeout: 15000

# Collections configuration
solr_collections:
  - blacklight
solr_collections_template_path: "{{ playbook_dir }}/templates/collections/"
solr_collections_transfer_mode: synchronize  # synchronize, copy

# External libs support
solr_external_libraries_repository_url: http://repo1.maven.org/maven2
solr_external_libraries: {}
